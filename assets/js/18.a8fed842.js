(window.webpackJsonp=window.webpackJsonp||[]).push([[18],{458:function(t,e,a){"use strict";a.r(e);var _=a(35),n=Object(_.a)({},(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"mysql"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#mysql"}},[t._v("#")]),t._v(" MySQL")]),t._v(" "),a("PostTags",{attrs:{tags:t.$page.frontmatter.tags}}),t._v(" "),a("p"),a("div",{staticClass:"table-of-contents"},[a("ul",[a("li",[a("a",{attrs:{href:"#事务隔离级别"}},[t._v("事务隔离级别")])]),a("li",[a("a",{attrs:{href:"#执行计划"}},[t._v("执行计划")])]),a("li",[a("a",{attrs:{href:"#备份与恢复"}},[t._v("备份与恢复")])])])]),a("p"),t._v(" "),a("h2",{attrs:{id:"事务隔离级别"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#事务隔离级别"}},[t._v("#")]),t._v(" 事务隔离级别")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",{staticStyle:{"text-align":"center"}},[t._v("事务隔离级别")]),t._v(" "),a("th",{staticStyle:{"text-align":"center"}},[t._v("脏读")]),t._v(" "),a("th",{staticStyle:{"text-align":"center"}},[t._v("不可重复读")]),t._v(" "),a("th",{staticStyle:{"text-align":"center"}},[t._v("幻读")])])]),t._v(" "),a("tbody",[a("tr",[a("td",{staticStyle:{"text-align":"center"}},[t._v("读未提交（RU）")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("可能")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("可能")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("可能")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"center"}},[t._v("读已提交（RC）")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("不可能")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("可能")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("可能")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"center"}},[t._v("可重复读（RR）")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("不可能")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("不可能")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("InnoDB不可能")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"center"}},[t._v("串行化（S）")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("不可能")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("不可能")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("不可能")])])])]),t._v(" "),a("h2",{attrs:{id:"执行计划"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#执行计划"}},[t._v("#")]),t._v(" 执行计划")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",{staticStyle:{"text-align":"center"}},[t._v("列名")]),t._v(" "),a("th",{staticStyle:{"text-align":"center"}},[t._v("含义")]),t._v(" "),a("th",[t._v("备注")])])]),t._v(" "),a("tbody",[a("tr",[a("td",{staticStyle:{"text-align":"center"}},[t._v("id")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("控制执行顺序")]),t._v(" "),a("td",[t._v("当 id 相同时，执行顺序 由上向下;当 id 不同时，id 值越大，优先级越高，越先执行")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"center"}},[t._v("select_type")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("查询类型")]),t._v(" "),a("td")]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"center"}},[t._v("type")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("表的访问类型")]),t._v(" "),a("td",[t._v("性能由高到低：system > const > eq_ref > ref > fulltext > ref_or_null > index_merge > unique_subquery > index_subquery > range > index > ALL")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"center"}},[t._v("possible_keys")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("可能用到的索引们")]),t._v(" "),a("td")]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"center"}},[t._v("key")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("实际用到的索引")]),t._v(" "),a("td",[t._v("如果为 NULL，则表示未用到索引")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"center"}},[t._v("key_len")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("索引长度")]),t._v(" "),a("td")]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"center"}},[t._v("ref")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("当使用索引等值查询时，与索引作比较的列或常量")]),t._v(" "),a("td")]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"center"}},[t._v("rows")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("预计要读取的行数")]),t._v(" "),a("td")]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"center"}},[t._v("filtered")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("按表条件过滤后，留存的记录数的百分比")]),t._v(" "),a("td")]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"center"}},[t._v("extra")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("附加信息")]),t._v(" "),a("td",[t._v("Using filesort：在排序时使用了外部的索引排序，没有用到表内索引进行排序；Using temporary：MySQL 需要创建临时表来存储查询的结果，常见于 ORDER BY 和 GROUP BY；Using index：表明查询使用了覆盖索引，不用回表，查询效率非常高；Using index condition：表示查询优化器选择使用了索引条件下推这个特性；Using where：表明查询使用了 WHERE 子句进行条件过滤，一般在没有使用到索引的时候会出现；Using join buffer (Block Nested Loop)：连表查询的方式，表示当被驱动表的没有使用索引的时候，MySQL 会先将驱动表读出来放到 join buffer 中，再遍历被驱动表与驱动表进行查询")])])])]),t._v(" "),a("p",[t._v("即使走了索引（key有值），查询也不一定快：")]),t._v(" "),a("ul",[a("li",[t._v("访问类型为index，虽然在内存中，但也是扫描整颗索引树，比ALL全表扫描好但也很慢。")]),t._v(" "),a("li",[t._v("查询字段太多，join表过多（限定最多3个比较合适）。")]),t._v(" "),a("li",[t._v("索引设计问题，区分度不高，约等于没有。")]),t._v(" "),a("li",[t._v("系统IO负载过高，影响了数据库运行。")]),t._v(" "),a("li",[t._v("优化器选错了索引（概率较低），用"),a("code",[t._v("forece index")]),t._v("强行指定索引。")]),t._v(" "),a("li",[t._v("数据量真的太大了，啥索引都没用，考虑分库分表。")])]),t._v(" "),a("h2",{attrs:{id:"备份与恢复"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#备份与恢复"}},[t._v("#")]),t._v(" 备份与恢复")]),t._v(" "),a("ul",[a("li",[t._v("mysqldump"),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# dump，有-d则只导出数据库schema")]),t._v("\nmysqldump -u user -p "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("-d"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" database --default-character-set"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("utf8mb4 --result-file"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("dump.sql\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# restore")]),t._v("\nmysql -u user -p database "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v(" dump.sql\n")])])])])])],1)}),[],!1,null,null,null);e.default=n.exports}}]);